from Crypto.Util.number import long_to_bytes as l2b, bytes_to_long as b2l
import string

enc_flag = (1009853499474982445328306423351502268359469603166971748797863175695912123759335485953225067777560529561008799865712723186223895186674368586682467534654335132069160510041192015593077674924902043338557574519107689735364291581384897742973532630432858307701183373527122024141520468182653200853001530366332181934, 122362948828703966330493235167810950457956420609451918193641088386663312360146786180800786289759843404954218268285919532794285004610252643224591064100011151132805493156645547278138536432041722751276223218778337359513193233058197044327047253238858218542302639053632865039718730314336684488788847573132502331086)
p, q, g, h = (223996490457960864452388650527715361387387922718810476753122422833318799096315418789535042044449652998225575663927035319000205038028506739154899556565889030636118128942829521431622848916466461332900817726731954705669406777404791722745554506502221083262906258338536573628659417749353296867444672156214515235047, 111998245228980432226194325263857680693693961359405238376561211416659399548157709394767521022224826499112787831963517659500102519014253369577449778282944515318059064471414760715811424458233230666450408863365977352834703388702395861372777253251110541631453129169268286814329708874676648433722336078107257617523, 2, 186324581694998367858054429926557628292418372502135258306229127485264087262414438893903567317541687049794441480506461466769204224604689676378355816870645437219983933384025918562049021606354999411278578970929636717790223508039079833335573841744310759573039198329329688255401126014217453700576506716244154238143)
with open('output.txt') as f:
    f.readline() ; f.readline()
    c2s = eval(f.readline())[::-1]

ALPHABET = string.ascii_letters + string.digits

randomness = b''

for i, c2 in enumerate(c2s):
    for b in range(256):
        y = bytes([b])
        s = pow(h, b2l(randomness + y), p)
        m = l2b(c2*pow(s,-1,p)%p)
        if all([chr(i) in ALPHABET for i in m]):
            randomness += y
            break
    else:
        print('oops')

for b in range(256):
    y = b2l(randomness + bytes([b]))
    s = pow(h, y, p)
    m = l2b(enc_flag[1] * pow(s, -1, p) % p)
    if b'NH4CK{' in m:
        print(m)
        break
